<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Still Grateful ‚Äî Thank someone who shaped you</title>
  <meta name="description" content="Send an anonymous message of gratitude. No reply expected. No social pressure. Just appreciation, delivered.">
  
  <!-- Open Graph / Social -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://stillgrateful.app/">
  <meta property="og:title" content="Still Grateful ‚Äî Thank someone who shaped you">
  <meta property="og:description" content="Send an anonymous message of gratitude. No reply expected. No social pressure. Just appreciation, delivered.">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Still Grateful ‚Äî Thank someone who shaped you">
  <meta name="twitter:description" content="Send an anonymous message of gratitude. No reply expected. No social pressure. Just appreciation, delivered.">
  
  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üôè</text></svg>">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;1,300&family=Inter:wght@400;500&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --color-bg: #faf9f7;
      --color-bg-warm: #f5f3ef;
      --color-text: #3d3d3d;
      --color-text-muted: #6b6b6b;
      --color-accent: #5c7c6b;
      --color-accent-hover: #4a6757;
      --color-border: #e0ddd8;
      --color-success: #5c7c6b;
      --color-error: #b85c5c;
      --font-serif: 'Merriweather', Georgia, serif;
      --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    }

    html {
      font-size: 16px;
    }

    body {
      font-family: var(--font-sans);
      background-color: var(--color-bg);
      color: var(--color-text);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Header */
    header {
      padding: 1.5rem 1.5rem 1rem;
      text-align: center;
    }

    .wordmark {
      font-family: var(--font-serif);
      font-size: 1.25rem;
      font-weight: 400;
      color: var(--color-text);
      letter-spacing: 0.02em;
    }

    /* Main Content */
    main {
      flex: 1;
      width: 100%;
      max-width: 540px;
      margin: 0 auto;
      padding: 1rem 1.5rem 3rem;
    }

    /* Hero Section */
    .hero {
      text-align: center;
      margin-bottom: 2.5rem;
    }

    .hero h1 {
      font-family: var(--font-serif);
      font-size: 1.75rem;
      font-weight: 400;
      line-height: 1.3;
      margin-bottom: 1rem;
      color: var(--color-text);
    }

    .hero p {
      font-size: 1rem;
      color: var(--color-text-muted);
      line-height: 1.7;
    }

    /* Form */
    .gratitude-form {
      background: var(--color-bg-warm);
      border-radius: 12px;
      padding: 1.75rem 1.5rem;
      border: 1px solid var(--color-border);
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-group:last-of-type {
      margin-bottom: 1.75rem;
    }

    label {
      display: block;
      font-size: 0.9rem;
      font-weight: 500;
      color: var(--color-text);
      margin-bottom: 0.5rem;
    }

    input[type="email"],
    select,
    textarea {
      width: 100%;
      padding: 0.875rem 1rem;
      font-family: var(--font-sans);
      font-size: 1rem;
      color: var(--color-text);
      background: #fff;
      border: 1px solid var(--color-border);
      border-radius: 8px;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }

    input[type="email"]:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: var(--color-accent);
      box-shadow: 0 0 0 3px rgba(92, 124, 107, 0.1);
    }

    input[type="email"]::placeholder,
    textarea::placeholder {
      color: #aaa;
    }

    select {
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%236b6b6b' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 1rem center;
      padding-right: 2.5rem;
    }

    textarea {
      min-height: 180px;
      resize: vertical;
      line-height: 1.6;
    }

    .char-count {
      text-align: right;
      font-size: 0.8rem;
      color: var(--color-text-muted);
      margin-top: 0.4rem;
    }

    .char-count.warning {
      color: var(--color-error);
    }

    /* Submit Button */
    .submit-btn {
      width: 100%;
      padding: 1rem 1.5rem;
      font-family: var(--font-sans);
      font-size: 1rem;
      font-weight: 500;
      color: #fff;
      background-color: var(--color-accent);
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.2s ease, transform 0.1s ease;
    }

    .submit-btn:hover:not(:disabled) {
      background-color: var(--color-accent-hover);
    }

    .submit-btn:active:not(:disabled) {
      transform: scale(0.98);
    }

    .submit-btn:disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }

    .submit-btn.loading {
      position: relative;
      color: transparent;
    }

    .submit-btn.loading::after {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 20px;
      margin: -10px 0 0 -10px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Status Messages */
    .status-message {
      margin-top: 1.25rem;
      padding: 1rem 1.25rem;
      border-radius: 8px;
      font-size: 0.95rem;
      line-height: 1.6;
      display: none;
    }

    .status-message.success {
      display: block;
      background-color: rgba(92, 124, 107, 0.1);
      color: var(--color-success);
      border: 1px solid rgba(92, 124, 107, 0.2);
    }

    .status-message.error {
      display: block;
      background-color: rgba(184, 92, 92, 0.1);
      color: var(--color-error);
      border: 1px solid rgba(184, 92, 92, 0.2);
    }

    /* Success State */
    .form-success {
      text-align: center;
      padding: 2rem 1rem;
    }

    .form-success h2 {
      font-family: var(--font-serif);
      font-size: 1.5rem;
      font-weight: 400;
      margin-bottom: 1rem;
      color: var(--color-text);
    }

    .form-success p {
      color: var(--color-text-muted);
      margin-bottom: 1.5rem;
    }

    .send-another-btn {
      display: inline-block;
      padding: 0.75rem 1.5rem;
      font-family: var(--font-sans);
      font-size: 0.9rem;
      font-weight: 500;
      color: var(--color-accent);
      background: transparent;
      border: 1px solid var(--color-accent);
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.2s ease, color 0.2s ease;
    }

    .send-another-btn:hover {
      background-color: var(--color-accent);
      color: #fff;
    }

    /* Footer */
    footer {
      background-color: var(--color-bg-warm);
      border-top: 1px solid var(--color-border);
      padding: 2.5rem 1.5rem;
      text-align: center;
    }

    .footer-content {
      max-width: 480px;
      margin: 0 auto;
    }

    .footer-description {
      font-size: 0.9rem;
      color: var(--color-text-muted);
      line-height: 1.7;
      margin-bottom: 1.5rem;
    }

    .footer-apps {
      font-size: 0.85rem;
      color: var(--color-text-muted);
      margin-bottom: 1rem;
    }

    .footer-credit {
      font-size: 0.8rem;
      color: #999;
    }

    /* Responsive */
    @media (min-width: 640px) {
      header {
        padding: 2rem 2rem 1.5rem;
      }

      main {
        padding: 2rem 2rem 4rem;
      }

      .hero h1 {
        font-size: 2rem;
      }

      .gratitude-form {
        padding: 2rem;
      }
    }

    /* Validation styles */
    input:invalid:not(:placeholder-shown),
    select:invalid:not([value=""]),
    textarea:invalid:not(:placeholder-shown) {
      border-color: var(--color-error);
    }

    .field-error {
      font-size: 0.8rem;
      color: var(--color-error);
      margin-top: 0.35rem;
      display: none;
    }

    .field-error.visible {
      display: block;
    }
  </style>
</head>
<body>
  <header>
    <div class="wordmark">Still Grateful</div>
  </header>

  <main>
    <section class="hero">
      <h1>Thank someone who shaped you.</h1>
      <p>Send an anonymous message of gratitude. No reply expected. No social pressure. Just appreciation, delivered.</p>
    </section>

    <div class="gratitude-form" id="formContainer">
      <form id="gratitudeForm" novalidate>
        <div class="form-group">
          <label for="recipientEmail">Their email address</label>
          <input 
            type="email" 
            id="recipientEmail" 
            name="recipientEmail" 
            placeholder="someone@example.com"
            required
            autocomplete="email"
          >
          <div class="field-error" id="emailError">Please enter a valid email address</div>
        </div>

        <div class="form-group">
          <label for="contextTag">How do you know them?</label>
          <select id="contextTag" name="contextTag" required>
            <option value="" disabled selected>Select a relationship</option>
            <option value="former-student">A former student</option>
            <option value="former-teacher">A former teacher</option>
            <option value="old-friend">An old friend</option>
            <option value="former-colleague">A former colleague</option>
            <option value="former-teammate">A former teammate</option>
            <option value="family-member">A family member</option>
            <option value="mentor">A mentor</option>
            <option value="other">Someone from your past</option>
          </select>
          <div class="field-error" id="contextError">Please select how you know this person</div>
        </div>

        <div class="form-group">
          <label for="message">Your message</label>
          <textarea 
            id="message" 
            name="message" 
            placeholder="Write your message here..."
            required
            maxlength="2000"
          ></textarea>
          <div class="char-count"><span id="charCount">0</span> / 2000</div>
          <div class="field-error" id="messageError">Please write a message</div>
        </div>

        <button type="submit" class="submit-btn" id="submitBtn">Send Gratitude</button>

        <div class="status-message" id="statusMessage"></div>
      </form>

      <div class="form-success" id="formSuccess" style="display: none;">
        <h2>Sent with care.</h2>
        <p>Your gratitude is on its way. They'll never know it was you‚Äîbut they'll know someone cared.</p>
        <button class="send-another-btn" id="sendAnotherBtn">Send another</button>
      </div>
    </div>
  </main>

  <footer>
    <div class="footer-content">
      <p class="footer-description">
        Still Grateful lets you thank people anonymously‚Äîteachers who changed your path, friends who helped you through hard times, mentors who believed in you. No account needed. No reply possible. Just gratitude, delivered.
      </p>
      <p class="footer-apps">iOS and Android apps coming soon</p>
      <p class="footer-credit">This is a non-profit project.</p>
    </div>
  </footer>

  <script>
    (function() {
      // DOM Elements
      const form = document.getElementById('gratitudeForm');
      const formContainer = document.getElementById('formContainer');
      const formSuccess = document.getElementById('formSuccess');
      const submitBtn = document.getElementById('submitBtn');
      const statusMessage = document.getElementById('statusMessage');
      const sendAnotherBtn = document.getElementById('sendAnotherBtn');
      
      const emailInput = document.getElementById('recipientEmail');
      const contextSelect = document.getElementById('contextTag');
      const messageTextarea = document.getElementById('message');
      const charCount = document.getElementById('charCount');
      
      const emailError = document.getElementById('emailError');
      const contextError = document.getElementById('contextError');
      const messageError = document.getElementById('messageError');

      const API_URL = 'https://stillgrateful-api.jackchambers5.workers.dev/send';
      const STORAGE_KEY = 'stillgrateful_sender_token';

      // Get or create sender token
      function getSenderToken() {
        let token = localStorage.getItem(STORAGE_KEY);
        if (!token) {
          token = crypto.randomUUID();
          localStorage.setItem(STORAGE_KEY, token);
        }
        return token;
      }

      // Character count
      messageTextarea.addEventListener('input', function() {
        const count = this.value.length;
        charCount.textContent = count;
        charCount.parentElement.classList.toggle('warning', count > 1900);
      });

      // Email validation
      function isValidEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
      }

      // Clear errors
      function clearErrors() {
        emailError.classList.remove('visible');
        contextError.classList.remove('visible');
        messageError.classList.remove('visible');
        statusMessage.className = 'status-message';
        statusMessage.textContent = '';
      }

      // Validate form
      function validateForm() {
        let isValid = true;
        clearErrors();

        if (!emailInput.value.trim() || !isValidEmail(emailInput.value.trim())) {
          emailError.classList.add('visible');
          isValid = false;
        }

        if (!contextSelect.value) {
          contextError.classList.add('visible');
          isValid = false;
        }

        if (!messageTextarea.value.trim()) {
          messageError.classList.add('visible');
          isValid = false;
        }

        return isValid;
      }

      // Show error message
      function showError(message) {
        statusMessage.textContent = message;
        statusMessage.className = 'status-message error';
      }

      // Show success state
      function showSuccess() {
        form.style.display = 'none';
        formSuccess.style.display = 'block';
      }

      // Reset form
      function resetForm() {
        form.reset();
        charCount.textContent = '0';
        charCount.parentElement.classList.remove('warning');
        clearErrors();
        form.style.display = 'block';
        formSuccess.style.display = 'none';
      }

      // Submit form
      async function handleSubmit(e) {
        e.preventDefault();

        if (!validateForm()) {
          return;
        }

        submitBtn.disabled = true;
        submitBtn.classList.add('loading');
        clearErrors();

        const payload = {
          message: messageTextarea.value.trim(),
          recipient_email: emailInput.value.trim(),
          context_tag: contextSelect.value,
          sender_token: getSenderToken()
        };

        try {
          const response = await fetch(API_URL, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(payload)
          });

          const data = await response.json();

          if (response.ok) {
            showSuccess();
          } else {
            showError(data.error || 'Something went wrong. Please try again.');
          }
        } catch (error) {
          showError('Unable to send your message. Please check your connection and try again.');
        } finally {
          submitBtn.disabled = false;
          submitBtn.classList.remove('loading');
        }
      }

      // Event listeners
      form.addEventListener('submit', handleSubmit);
      sendAnotherBtn.addEventListener('click', resetForm);

      // Clear individual field errors on input
      emailInput.addEventListener('input', () => emailError.classList.remove('visible'));
      contextSelect.addEventListener('change', () => contextError.classList.remove('visible'));
      messageTextarea.addEventListener('input', () => messageError.classList.remove('visible'));
    })();
  </script>
</body>
</html>
